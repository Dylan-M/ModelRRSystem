#* 
#* ------------------------------------------------------------------
#* Makefile.in - 
#* Created by Robert Heller on Sun Jul 28 09:58:05 2002
#* ------------------------------------------------------------------
#* Modification History: $Log$
#* Modification History: Revision 1.8  2004/06/26 13:31:09  heller
#* Modification History: Update versioning for new release
#* Modification History:
#* Modification History: Revision 1.7  2004/04/27 21:58:48  heller
#* Modification History: Added in CTC Documentation.
#* Modification History:
#* Modification History: Revision 1.6  2004/04/14 23:20:42  heller
#* Modification History: Updated copyright.
#* Modification History:
#* Modification History: Revision 1.5  2002/11/10 14:27:19  heller
#* Modification History: Updated for Time Table internals docs
#* Modification History:
#* Modification History: Revision 1.4  2002/11/10 00:40:16  heller
#* Modification History: Time Table Internals Docs
#* Modification History:
#* Modification History: Revision 1.3  2002/10/17 00:02:54  heller
#* Modification History: Internals documentation generation (Doc++ and SWIG).
#* Modification History:
#* Modification History: Revision 1.2  2002/07/28 14:03:50  heller
#* Modification History: Add it copyright notice headers
#* Modification History:
#* ------------------------------------------------------------------
#* Contents:
#* ------------------------------------------------------------------
#*  
#*     Model RR System, Version 2
#*     Copyright (C) 1994,1995,2002  Robert Heller D/B/A Deepwoods Software
#* 			51 Locke Hill Road
#* 			Wendell, MA 01379-9728
#* 
#*     This program is free software; you can redistribute it and/or modify
#*     it under the terms of the GNU General Public License as published by
#*     the Free Software Foundation; either version 2 of the License, or
#*     (at your option) any later version.
#* 
#*     This program is distributed in the hope that it will be useful,
#*     but WITHOUT ANY WARRANTY; without even the implied warranty of
#*     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#*     GNU General Public License for more details.
#* 
#*     You should have received a copy of the GNU General Public License
#*     along with this program; if not, write to the Free Software
#*     Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
#* 
#*  
#* 

prefix     = @prefix@
exec_prefix= @exec_prefix@
BIN_DIR        = $(exec_prefix)/bin
LIB_DIR        = $(exec_prefix)/lib
MRR_PATCH_LEVEL = @MRR_PATCH_LEVEL@
datadir = @datadir@
DOC_DIR        = $(datadir)/mrrsys-$(MRR_PATCH_LEVEL)/Docs
INSTALL	       = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA   = @INSTALL_DATA@
LATEX		= @LATEX@
DVIPS		= @DVIPS@
DVIDVI		= @DVIDVI@
PS2PDF		= @PS2PDF@
DOCXX		= @DOCXX@
MAKEINDEX	= @MAKEINDEX@
BIBTEX		= @BIBTEX@
SUFFIXES	= .tcl .sty
DVIPSFLAGS	= -t letter
#GUPDVIPSFLAGS   = -P GUP -x 823 -t GUP
ODDPAGES = 2:0
EVENPAGES = 2:-1

C_INTERNALS_H = Intro.h \
	../../C++/Classes/IntegerList.h ../../C++/Classes/ParseFile.h \
	../../C++/Classes/TrackBody.h ../../C++/Classes/TurnoutBody.h \
	../../C++/Classes/TrackGraph.h \
	Biblio.h
C_INTERNALS_H_HERE = Intro.h Biblio.h
C_INTERNALS_PDF = CxxInternals.pdf
C_INTERNALS_PS = CxxInternals.ps
#C_INTERNALS_GUP_PDF = CxxInternals_GUP.pdf
#C_INTERNALS_GUP_PS = CxxInternals_GUP.ps
C_INTERNALS_DVI = CxxInternals.dvi
C_INTERNALS_E_PS = CxxInternalsE.ps
C_INTERNALS_E_DVI = CxxInternalsE.dvi
C_INTERNALS_O_PS = CxxInternalsO.ps
C_INTERNALS_O_DVI = CxxInternalsO.dvi
C_INTERNALS_LATEX = CxxInternals.tex
C_INTERNALS_LATEX_ENV = CxxInternals.texenv
C_INTERNALS = CxxInternals

SWIG_INTERNALS_PDF = SwigInternals.pdf
SWIG_INTERNALS_PS = SwigInternals.ps
#SWIG_INTERNALS_GUP_PDF = SwigInternals_GUP.pdf
#SWIG_INTERNALS_GUP_PS = SwigInternals_GUP.ps
SWIG_INTERNALS_DVI = SwigInternals.dvi
SWIG_INTERNALS_E_PS = SwigInternalsE.ps
SWIG_INTERNALS_E_DVI = SwigInternalsE.dvi
SWIG_INTERNALS_O_PS = SwigInternalsO.ps
SWIG_INTERNALS_O_DVI = SwigInternalsO.dvi
SWIG_INTERNALS_LATEX = SwigInternals.tex
SWIG_INTERNALS_SED   = SwigInternals.sed
SWIG_INTERNALS = SwigInternals
SWIG_DIR = ../../C++/Swig/
SWIG_ORIG_LATEX = mrr_wrap.tex
SWIG_INTERFACE = $(SWIG_DIR)mrr.i

TCL2TEX = ../Support/tcl2tex.sh

#COMMON_TCL_INTERNALS = ../../Scripts/StdMenuBar.tcl
#TT_TCL_INTERNALS = ../../Scripts/TimeTable/mrrTimeTable.tcl ../../Scripts/TimeTable/MakeTimeTable.tcl

TCL_INTERNALS_PDF = TclInternals.pdf
TCL_INTERNALS_PS = TclInternals.ps
TCL_INTERNALS_DVI = TclInternals.dvi
TCL_INTERNALS_E_PS = TclInternalsE.ps
TCL_INTERNALS_E_DVI = TclInternalsE.dvi
TCL_INTERNALS_O_PS = TclInternalsO.ps
TCL_INTERNALS_O_DVI = TclInternalsO.dvi
COMMON_TCL_INTERNALS_LATEXSX = StdMenuBar.tex CTCPanel.tex
TT_TCL_INTERNALS_LATEXSX = mrrTimeTable.tex MakeTimeTable.tex
TCL_INTERNALS_LATEXSX = $(COMMON_TCL_INTERNALS_LATEXSX) \
			$(TT_TCL_INTERNALS_LATEXSX)
TCL_INTERNALS_LATEXS = IntroTclInternals.tex ../MyTitlepage.sty ../MyPart.sty \
	titlepage.tex $(TT_TCL_INTERNALS_LATEXSX) \
	$(COMMON_TCL_INTERNALS_LATEXSX) common_part.tex \
	timetable_part.tex
TCL_INTERNALS_LATEX = TclInternals.tex 
TCL_INTERNALS_IND = TclInternals.ind
TCL_INTERNALS_IDX = TclInternals.idx
TCL_INTERNALSBase = TclInternals

BIBLIO = ../MRR.bib

%.tex: %.tcl
	$(TCL2TEX) -forinput $@ $<

%.pdf: %.ps
	$(PS2PDF) $< $@
ifeq ($(DOCXX),/bin/true)
all: $(C_INTERNALS_PS) $(SWIG_INTERNALS_PS) $(TCL_INTERNALS_PS)
else
all: $(SWIG_INTERNALS_PS) $(TCL_INTERNALS_PS)
endif

doubleOnSingle: $(C_INTERNALS_E_PS) $(C_INTERNALS_O_PS) \
	        $(SWIG_INTERNALS_E_PS) $(SWIG_INTERNALS_O_PS) \
		$(TCL_INTERNALS_E_PS) $(TCL_INTERNALS_O_PS)

ifeq ($(DOCXX),/bin/true)
PDF: $(SWIG_INTERNALS_PDF) $(TCL_INTERNALS_PDF)
else
PDF: $(SWIG_INTERNALS_PDF) $(C_INTERNALS_PDF) $(TCL_INTERNALS_PDF)
endif
#GUPPDF: $(SWIG_INTERNALS_GUP_PDF) $(C_INTERNALS_GUP_PDF) # $(TCL_INTERNALS_GUP_PDF)

ifeq ($(DOCXX),/bin/true)
ALLINSTALLDOCS = $(SWIG_INTERNALS_PS) $(TCL_INTERNALS_PS) \
		 $(SWIG_INTERNALS_PDF) $(TCL_INTERNALS_PDF)
else
ALLINSTALLDOCS = $(SWIG_INTERNALS_PS) $(TCL_INTERNALS_PS) \
		 $(SWIG_INTERNALS_PDF) $(TCL_INTERNALS_PDF) \
		 $(C_INTERNALS_PS) $(C_INTERNALS_PDF)
endif

titlepage.tex : ../titlepage.tex
	ln -s ../titlepage.tex ./titlepage.tex

$(C_INTERNALS_PS) : $(C_INTERNALS_DVI)
	$(DVIPS) $(DVIPSFLAGS) $(C_INTERNALS_DVI) -o $(C_INTERNALS_PS)

#$(C_INTERNALS_GUP_PS) : $(C_INTERNALS_DVI) config.GUP
#	$(DVIPS) $(GUPDVIPSFLAGS) $(C_INTERNALS_DVI) -o $(C_INTERNALS_GUP_PS)

$(C_INTERNALS_E_PS) : $(C_INTERNALS_E_DVI)
	$(DVIPS) $(DVIPSFLAGS) $(C_INTERNALS_E_DVI) -o $(C_INTERNALS_E_PS)

$(C_INTERNALS_O_PS) : $(C_INTERNALS_O_DVI)
	$(DVIPS) $(DVIPSFLAGS) $(C_INTERNALS_O_DVI) -o $(C_INTERNALS_O_PS)

$(C_INTERNALS_E_DVI) : $(C_INTERNALS_DVI)
	$(DVIDVI) $(EVENPAGES) $(C_INTERNALS_DVI) $(C_INTERNALS_E_DVI)

$(C_INTERNALS_O_DVI) : $(C_INTERNALS_DVI)
	$(DVIDVI) $(ODDPAGES) $(C_INTERNALS_DVI) $(C_INTERNALS_O_DVI)

$(C_INTERNALS_DVI) : $(C_INTERNALS_LATEX) docxx.sty $(BIBLIO) \
	../MyTitlepage.sty titlepage.tex # ../Cover1.ps
	$(LATEX) $(C_INTERNALS_LATEX)
	-$(BIBTEX) $(C_INTERNALS)
	$(LATEX) $(C_INTERNALS_LATEX)
	$(LATEX) $(C_INTERNALS_LATEX)

$(C_INTERNALS_LATEX) : $(C_INTERNALS_H) $(C_INTERNALS_LATEX_ENV)
	$(DOCXX) -t -v -p -ef $(C_INTERNALS_LATEX_ENV) -l -o $(C_INTERNALS_LATEX) $(C_INTERNALS_H)
	echo '\end{document}' >>$(C_INTERNALS_LATEX)

$(SWIG_INTERNALS_PS) : $(SWIG_INTERNALS_DVI)
	$(DVIPS) $(DVIPSFLAGS) $(SWIG_INTERNALS_DVI) -o $(SWIG_INTERNALS_PS)

#$(SWIG_INTERNALS_GUP_PS) : $(SWIG_INTERNALS_DVI) config.GUP
#	$(DVIPS) $(GUPDVIPSFLAGS) $(SWIG_INTERNALS_DVI) -o $(SWIG_INTERNALS_GUP_PS)

$(SWIG_INTERNALS_E_PS) : $(SWIG_INTERNALS_E_DVI)
	$(DVIPS) $(DVIPSFLAGS) $(SWIG_INTERNALS_E_DVI) -o $(SWIG_INTERNALS_E_PS)

$(SWIG_INTERNALS_O_PS) : $(SWIG_INTERNALS_O_DVI)
	$(DVIPS) $(DVIPSFLAGS) $(SWIG_INTERNALS_O_DVI) -o $(SWIG_INTERNALS_O_PS)

$(SWIG_INTERNALS_E_DVI) : $(SWIG_INTERNALS_DVI)
	$(DVIDVI) $(EVENPAGES) $(SWIG_INTERNALS_DVI) $(SWIG_INTERNALS_E_DVI)

$(SWIG_INTERNALS_O_DVI) : $(SWIG_INTERNALS_DVI)
	$(DVIDVI) $(ODDPAGES) $(SWIG_INTERNALS_DVI) $(SWIG_INTERNALS_O_DVI)

$(SWIG_INTERNALS_DVI) : $(SWIG_INTERNALS_LATEX) ../MyTitlepage.sty \
	titlepage.tex $(BIBLIO) # ../Cover1.ps
	$(LATEX) $(SWIG_INTERNALS_LATEX)
	-$(BIBTEX) $(SWIG_INTERNALS)
	echo '\begin{theindex}' > $(SWIG_INTERNALS).ind
	echo '\item Dummy, 0' >> $(SWIG_INTERNALS).ind
	echo '\end{theindex}' >> $(SWIG_INTERNALS).ind
	$(LATEX) $(SWIG_INTERNALS_LATEX)
	$(MAKEINDEX) $(SWIG_INTERNALS).idx
	$(LATEX) $(SWIG_INTERNALS_LATEX)

$(SWIG_INTERNALS_LATEX) : $(SWIG_DIR)$(SWIG_ORIG_LATEX) $(SWIG_INTERNALS_SED)
	sed -f $(SWIG_INTERNALS_SED) \
	<$(SWIG_DIR)$(SWIG_ORIG_LATEX) >$(SWIG_INTERNALS_LATEX)

$(SWIG_DIR)$(SWIG_ORIG_LATEX) : $(SWIG_INTERFACE)
	make -C $(SWIG_DIR) $(SWIG_ORIG_LATEX)


$(TCL_INTERNALS_E_DVI) : $(TCL_INTERNALS_DVI)
	$(DVIDVI) $(EVENPAGES) $(TCL_INTERNALS_DVI) $(TCL_INTERNALS_E_DVI)

$(TCL_INTERNALS_O_DVI) : $(TCL_INTERNALS_DVI)
	$(DVIDVI) $(ODDPAGES) $(TCL_INTERNALS_DVI) $(TCL_INTERNALS_O_DVI)

$(TCL_INTERNALS_DVI) : $(TCL_INTERNALS_LATEX) $(TCL_INTERNALS_LATEXS) \
	$(BIBLIO)  # ../Cover1.ps
	$(LATEX) $(TCL_INTERNALS_LATEX)
	-$(BIBTEX) $(TCL_INTERNALSBase)
	echo '\begin{theindex}' > $(TCL_INTERNALS_IND)
	echo '\item Dummy, 0' >> $(TCL_INTERNALS_IND)
	echo '\end{theindex}' >> $(TCL_INTERNALS_IND)
	$(LATEX) $(TCL_INTERNALS_LATEX)
	$(MAKEINDEX) $(TCL_INTERNALS_IDX)
	$(LATEX) $(TCL_INTERNALS_LATEX)

$(TCL_INTERNALS_PS) : $(TCL_INTERNALS_DVI)
	$(DVIPS) $(DVIPSFLAGS) $(TCL_INTERNALS_DVI) -o $(TCL_INTERNALS_PS)

$(TCL_INTERNALS_E_PS) : $(TCL_INTERNALS_E_DVI)
	$(DVIPS) $(DVIPSFLAGS) $(TCL_INTERNALS_E_DVI) -o $(TCL_INTERNALS_E_PS)

$(TCL_INTERNALS_O_PS) : $(TCL_INTERNALS_O_DVI)
	$(DVIPS) $(DVIPSFLAGS) $(TCL_INTERNALS_O_DVI) -o $(TCL_INTERNALS_O_PS)

StdMenuBar.tex : ../../Scripts/Common/StdMenuBar.tcl
	$(TCL2TEX) -forinput $@ $<

CTCPanel.tex : ../../Scripts/Common/CTCPanel.tcl
	$(TCL2TEX) -forinput $@ $<

mrrTimeTable.tex : ../../Scripts/TimeTable/mrrTimeTable.tcl
	$(TCL2TEX) -forinput $@ $<

MakeTimeTable.tex : ../../Scripts/TimeTable/MakeTimeTable.tcl 
	$(TCL2TEX) -forinput $@ $<


clean:
	rm -f *.dvi *.aux *.log $(SWIG_INTERNALS_LATEX) $(C_INTERNALS_LATEX) \
		*.ind *.idx *.ilg *.toc *.lof *.lot *.bbl *.blg \
		$(TCL_INTERNALS_LATEXSX)

install:  $(ALLINSTALLDOCS)
	$(INSTALL) -d $(DOC_DIR)
	for i in $^; do $(INSTALL_DATA) $$i $(DOC_DIR); done

distclean: clean
	rm -f Makefile

nodocclean: clean
	rm -f $(C_INTERNALS_PDF) $(C_INTERNALS_PS) $(C_INTERNALS_GUP_PDF) \
	      $(C_INTERNALS_GUP_PS) $(SWIG_INTERNALS_PDF) $(SWIG_INTERNALS_PS) \
	      $(SWIG_INTERNALS_GUP_PDF) $(SWIG_INTERNALS_GUP_PS) \
	      $(TCL_INTERNALS_PDF) $(TCL_INTERNALS_PS) \
	      $(TCL_INTERNALS_GUP_PDF) $(TCL_INTERNALS_GUP_PS) *_[OE].ps

