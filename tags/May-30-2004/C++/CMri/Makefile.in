#* 
#* ------------------------------------------------------------------
#* Makefile.in - C/MRI Serial interface code
#* Created by Robert Heller on Sat Mar 13 10:42:22 2004
#* ------------------------------------------------------------------
#* Modification History: $Log$
#* Modification History: Revision 1.5  2004/04/17 16:54:48  heller
#* Modification History: Universal Test program for C/MRI cards.
#* Modification History:
#* Modification History: Revision 1.4  2004/03/16 14:49:28  heller
#* Modification History: Code comments added
#* Modification History:
#* Modification History: Revision 1.3  2004/03/16 02:37:39  heller
#* Modification History: Base class documentation
#* Modification History:
#* Modification History: Revision 1.2  2004/03/14 05:20:17  heller
#* Modification History: First Alpha Release Lockdown
#* Modification History:
#* Modification History: Revision 1.1  2004/03/13 15:49:28  heller
#* Modification History: Initial code
#* Modification History:
#* Modification History: Revision 1.1  2002/07/28 14:03:50  heller
#* Modification History: Add it copyright notice headers
#* Modification History:
#* ------------------------------------------------------------------
#* Contents:
#* ------------------------------------------------------------------
#*  
#*     Model RR System, Version 2
#*     Copyright (C) 1994,1995,2002  Robert Heller D/B/A Deepwoods Software
#* 			51 Locke Hill Road
#* 			Wendell, MA 01379-9728
#* 
#*     This program is free software; you can redistribute it and/or modify
#*     it under the terms of the GNU General Public License as published by
#*     the Free Software Foundation; either version 2 of the License, or
#*     (at your option) any later version.
#* 
#*     This program is distributed in the hope that it will be useful,
#*     but WITHOUT ANY WARRANTY; without even the implied warranty of
#*     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#*     GNU General Public License for more details.
#* 
#*     You should have received a copy of the GNU General Public License
#*     along with this program; if not, write to the Free Software
#*     Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
#* 
#*  
#* 

prefix     = @prefix@
exec_prefix= @exec_prefix@
LIB_DIR        = ../../Lib
INSTALL         = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA    = @INSTALL_DATA@
CXX             = @CXX@
BaseCXXFLAGS    = @CXXFLAGS@
DEFS		= @DEFS@
SHLIB_CFLAGS    = @TCL_SHLIB_CFLAGS@
SHLIB_SUFFIX    = @TCL_SHLIB_SUFFIX@
SHLIB_LD        = @SHLIB_LD@
TCL_VERSION	= @TCL_VERSION@
VERSION		= @TCL_VERSION@
TCL_PREFIX      = @TCL_PREFIX@
TCL_EXEC_PREFIX	= @TCL_EXEC_PREFIX@
TCL_CFLAGS      = @TCL_CFLAGS@
TCL_DEFS	= @TCL_DEFS@
TCL_DBGX	= @TCL_DBGX@
TCLSH		= @TCLSH@
WISH		= @WISH@
TCL_LIB_SPEC	= @TCL_LIB_SPEC@
TCL_SHARED_LIBS	= @TCL_SHARED_LIBS@
INCLUDES        = -I$(TCL_PREFIX)/include -I.
SWIG		= @SWIG@ -tcl8 -c++
TARGET		= cmri
INTERFACE	= $(TARGET).i
SRCS		= $(TARGET)_wrap.cc $(TARGET).cc
OBJS		= $(TARGET)_wrap.o  $(TARGET).o
HDRS		= $(TARGET).h
CXXFLAGS = $(DEFS) $(TCL_DEFS) $(BaseCXXFLAGS) $(SHLIB_CFLAGS) $(INCLUDES) -c -Wall
LATEX           = @LATEX@
DVIPS           = @DVIPS@
DVIDVI          = @DVIDVI@
PS2PDF          = @PS2PDF@
DOCXX           = @DOCXX@
MAKEINDEX       = @MAKEINDEX@
BIBTEX          = @BIBTEX@
DVIPSFLAGS      = -t letter
ODDPAGES = 2:0
EVENPAGES = 2:-1

C_INTERNALS_LATEX_ENV = CxxInternals.texenv

BIBLIO = ../../Doc/MRR.bib

TARGETLIB = $(LIB_DIR)/$(TARGET)$(SHLIB_SUFFIX)

%.pdf: %.ps
	$(PS2PDF) $< $@


all: .depend $(LIB_DIR)/$(TARGET)$(SHLIB_SUFFIX) $(TARGET).pdf UniversalTest

titlepage.tex : ../../Doc/titlepage.tex
	ln -s ../../Doc/titlepage.tex ./titlepage.tex

docxx.sty : ../../Doc/Internals/docxx.sty
	ln -s ../../Doc/Internals/docxx.sty ./docxx.sty

$(TARGET).tex : $(TARGET).h CxxInternals.texenv
	$(DOCXX) -t -v -p -ef $(C_INTERNALS_LATEX_ENV) -l -o $(TARGET).tex $(TARGET).h
	echo '\end{document}' >>$(TARGET).tex

$(TARGET).dvi : $(TARGET).tex docxx.sty ../../Doc/MyTitlepage.sty \
		titlepage.tex $(BIBLIO)
	$(LATEX) $(TARGET)
	-$(BIBTEX) $(TARGET)
	$(LATEX) $(TARGET)
	$(LATEX) $(TARGET)

$(TARGET).ps : $(TARGET).dvi
	$(DVIPS) $(DVIPSFLAGS) $(TARGET).dvi -o $(TARGET).ps

$(TARGET).pdf : $(TARGET).ps

$(TARGET)_wrap.cc : $(INTERFACE)
	$(SWIG) -o $(TARGET)_wrap.cc $(INTERFACE) 

$(TARGETLIB) : $(OBJS)
	rm -f $(TARGETLIB)*
	$(SHLIB_LD) -o $(TARGETLIB) $(OBJS) $(TCL_SHARED_LIBS)

UniversalTest: UniversalTest.src
	sed -f ../../config_tcl.sed <UniversalTest.src >UniversalTest
	chmod +x UniversalTest

install: 

$(TARGET)_wrap.o : $(TARGET)_wrap.cc

$(TARGET).o : $(TARGET).cc

.depend: $(SRCS) $(HDRS)
	$(CXX) -M $(CXXFLAGS) $(SRCS)  > .depend

clean:
	rm -f $(OBJS) .depend

distclean: clean
	rm -f .depend Makefile $(TARGET)_wrap.cc $(LTEX) UniversalTest

#
# include a dependency file if one exists
#
ifeq (.depend,$(wildcard .depend))
include .depend
endif



